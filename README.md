![](image/snatcher.png)

---

## 项目背景

本项目的构思起源于学校的选课系统。每逢选课期间，学校的网站就会变得非常卡。这时候选课会变得极其困难，一个网页从请求到响应的时间最长在半个小时左右，这样长时间的等待会使人极其不耐烦。导致很多同学都无法安心的完成选课。这时候会有很多“选课高手”，他们有所谓的“选课技巧”可以快速完成选课。

渐渐的，“选课”这个词演变成为“抢课”。此时抢课也成为了一个小商机。据我所知，那些帮选课的也都是手动完成的，这意味着他们也需要花费很多时间在页面等待这方面，同时也意味着接单的数量会受到浏览器多开窗口个数的限制。

这时我在想：“为什么不开发出一个脚本，可以帮助我完成选课呢？”——最早起源于作者大一上学期（2022年）。

为此本项目应运而生。

## 项目开发周期

2023年10月24日——至今

## 项目技术栈

+ 后端：Python、FastAPI、MySQL、Redis、Celery。
+ 前端：Vue3、Element-Plus。

## 核心功能设计架构

![](image/%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84.png)

上述流程图只是简单的表示了项目的运行流程，这里简单的描述一下。

+ 在用户调用选课API之前，系统会提前挂起一个celery的任务队列进程，该进程用于监听选课API提交的任务。
+ 当用户调用了选课API之后程序会立马结束，而不会处于阻塞状态。
+ API被调用之后，首先会检查Redis中是否包含用户对应的会话。如果没有，系统会主动地去保存会话（如果会话设置失败，任务会直接结束）。接着获取选课的时间，最后再由API提交选课任务给celery任务队列。
+ 当到达任务设定的时间之后，celery的worker会不断的从任务队列中取出并执行任务。
+ 当任务被执行后，调用相应的课程选择器来进行选课操作，期间任意一个关键步骤失败都会记录失败信息。
+ 当选课成功后，系统会向目标用户发送一个选课成功的邮件，发送邮件也是一个celery任务，同样也会被提交到任务队列中。
+ 最后整个任务执行完毕。





